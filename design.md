# iOS闹钟应用设计文档

## 应用概述

本应用是一款功能完善的iOS闹钟应用,支持日历选择、重复规则、自定义铃声等功能。设计遵循iOS Human Interface Guidelines,界面简洁美观,交互直观易用,适配竖屏单手操作。

## 屏幕列表

### 1. 闹钟列表屏幕 (Home)
- **主要内容**: 显示所有已创建的闹钟列表
- **功能**: 
  - 查看所有闹钟(最多30个)
  - 快速开关闹钟
  - 左滑编辑/删除闹钟
  - 点击闹钟进入编辑页面
  - 底部浮动按钮添加新闹钟
- **信息展示**:
  - 闹钟时间(大号字体)
  - 闹钟标签/备注
  - 重复规则(图标+文字)
  - 启用/禁用开关
  - 顶部显示闹钟数量(如"15/30")

### 2. 添加/编辑闹钟屏幕
- **主要内容**: 闹钟详细设置表单
- **功能**:
  - 时间选择(滚轮选择器)
  - 日期选择(可选,默认不选)
  - 标签输入
  - 重复规则选择
  - 铃声选择
  - 保存/取消操作
- **布局分区**:
  - 时间设置区(顶部突出)
  - 基本设置区(标签、日期、重复)
  - 高级设置区(铃声)
  - 操作按钮区(底部固定)

### 3. 重复规则选择屏幕
- **主要内容**: 三种重复模式选择
- **功能**:
  - 每周重复(周一至周日多选)
  - 法定节假日(单选列表)
  - 自定义重复(间隔天数)
- **交互**:
  - 分段控制器切换模式
  - 实时显示选择摘要
  - 预览下次触发时间

### 4. 铃声选择屏幕
- **主要内容**: 系统铃声和自定义铃声列表
- **功能**:
  - 浏览系统预设铃声
  - 管理自定义铃声
  - 铃声预览播放(3秒)
  - 添加自定义铃声(文件选择器)
- **分组**:
  - 系统铃声区
  - 自定义铃声区

## 关键用户流程

### 流程1: 添加闹钟
1. 用户打开应用,看到闹钟列表
2. 点击底部橙色"+"按钮
3. 进入添加闹钟页面,滚动选择时间
4. (可选)输入标签、选择日期、设置重复规则、选择铃声
5. 点击"保存"按钮
6. 返回列表,新闹钟出现在顶部,默认启用

### 流程2: 编辑闹钟
1. 在列表页点击闹钟卡片或左滑选择"编辑"
2. 进入编辑页面,修改任意设置
3. 点击"保存"更新或"取消"放弃
4. 返回列表,更新立即显示

### 流程3: 快速开关闹钟
1. 在列表页点击闹钟右侧的开关按钮
2. 开关状态立即切换,颜色变化
3. 系统后台更新通知调度

### 流程4: 设置重复规则
1. 在添加/编辑页面点击"重复规则"
2. 进入重复规则选择页面
3. 选择模式(每周/节假日/自定义)
4. 设置具体规则
5. 返回,显示规则摘要

### 流程5: 选择铃声
1. 在添加/编辑页面点击"铃声"
2. 进入铃声选择页面
3. 点击铃声名称预览播放
4. 选择铃声或添加自定义铃声
5. 返回,显示铃声名称

## 色彩选择

### 主色调
- **强调色**: 橙色 (#FF9500 浅色模式, #FF9F0A 深色模式)
  - 用于按钮、开关、选中状态
  - 传达活力与警觉感

### 背景色
- **主背景**: 白色(浅色) / 黑色(深色)
- **次级背景**: 浅灰(#F5F5F5) / 深灰(#1C1C1E)
  - 用于卡片、列表项

### 文本色
- **主文本**: 黑色(浅色) / 白色(深色)
- **次级文本**: 灰色(#8E8E93)
  - 用于辅助信息

### 功能色
- **分割线**: #E5E5EA(浅色) / #38383A(深色)
- **禁用状态**: #C7C7CC(浅色) / #48484A(深色)

## 设计原则

### 1. 简洁性
- 界面元素精简,避免冗余
- 信息层级清晰,重点突出
- 留白适度,视觉舒适

### 2. 直观性
- 交互符合iOS用户习惯
- 操作无需学习成本
- 反馈及时明确

### 3. 一致性
- 遵循iOS设计规范
- 使用系统图标和字体
- 保持视觉风格统一

### 4. 可访问性
- 支持动态字体
- 高对比度模式
- VoiceOver支持

## 技术实现要点

### 数据存储
- 使用AsyncStorage本地存储闹钟数据
- 数据结构包含:时间、日期、标签、重复规则、铃声、启用状态

### 通知调度
- 使用expo-notifications
- 根据重复规则调度通知
- 处理权限请求

### 铃声管理
- 预设5-8个系统铃声
- 支持用户上传自定义铃声(MP3/M4A/WAV)
- 使用expo-audio播放预览

### 法定节假日
- 内置中国法定节假日数据(2026年)
- 支持节假日判断逻辑

## 交互细节

### 手势操作
- **点击**: 进入编辑页面
- **左滑**: 显示编辑/删除按钮
- **开关点击**: 切换启用状态

### 反馈机制
- **视觉**: 按钮高亮、动画过渡、Toast提示
- **触觉**: 开关震动、选择震动、警告震动
- **听觉**: 铃声预览、提示音

### 动画效果
- 页面切换: 标准iOS推入/推出动画
- 列表操作: 淡入淡出
- 开关切换: 平滑过渡

## 响应式适配

### 设备适配
- iPhone SE: 减小间距,优化按钮大小
- iPhone 14/15: 标准布局
- iPhone Pro Max: 增加内容区宽度

### 安全区域
- 顶部适配刘海屏和灵动岛
- 底部避开Home Indicator
- 使用SafeAreaView确保内容不被遮挡

## 无障碍支持

### VoiceOver
- 所有交互元素提供标签描述
- 闹钟卡片读出完整信息
- 按钮提供操作提示

### 动态字体
- 支持系统字体大小设置
- 布局自适应字体变化

### 高对比度
- 增强色彩对比
- 符合WCAG标准

## 性能优化

### 列表渲染
- 使用FlatList优化长列表
- 实现虚拟滚动

### 状态管理
- 使用React Context管理全局状态
- 避免不必要的重渲染

### 资源加载
- 铃声按需加载
- 图标使用SF Symbols

## 测试要点

### 功能测试
- 闹钟添加、编辑、删除
- 重复规则正确触发
- 通知准时推送
- 铃声正常播放

### 交互测试
- 手势操作流畅
- 反馈及时准确
- 动画自然顺滑

### 兼容性测试
- 不同设备适配
- 深色模式切换
- 系统版本兼容
